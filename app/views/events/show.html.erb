<% content_for :meta_title, "#{@event.title} is on #{DEFAULT_META["meta_product_name"]}" %>
<% content_for :meta_description, @event.description %>
<%# content_for :meta_image, image_path(@event.photo.key) if @event.photo.attached? %>

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">
<link href="https://fonts.googleapis.com/css2?family=Karla:wght@400;700&display=swap" rel="stylesheet">

<style>
  body {
    font-family: 'Karla', sans-serif;
  }
</style>

<div class="container mt-5">
  <div class="row">
    <div class="col-12 text-center">
      <h1 class="text-center text-primary"><%= @event.title %></h1>
        <% if @event.user == current_user %>
          <%= link_to "Update Event", edit_event_path(@event), class: "btn btn-secondary" %>
        <% end %>
        <% if @event.user_id == current_user.id %>
          <%= link_to "Cancel Event", event_path(@event), data: { turbo_method: :delete, confirm: "Are you sure you want to cancel this event?" }, class: "btn btn-danger" %>
        <% end %>
      <p class="text-center text-secondary">
        <strong>Sport:</strong> <%= @event.sport.name %><br>
        <strong>Description:</strong> <%= @event.description %><br>
        <strong>Level:</strong> <%= @event.level.name %><br>
        <strong>Location:</strong> <%= @event.location %><br>
        <strong>Date:</strong> <%= @event.date %><br>
        <strong>Time:</strong> <%= @event.time %>
      </p>
    </div>
  </div>
</div>

 <div class="row mt-5">
    <div class="col-12">
        <h3 class="text-center text-primary">Participants</h3>
        <ul class="list-unstyled">
          <% @event.participating_users.each do |participating_user| %>
          <li class="text-center text-secondary"><%= participating_user.user.username %></li>
          <% end %>
        </ul>
  </div>
</div>
 <div class="row mt-5">
    <div class="col-12 text-center">
      <% if current_user %>
        <% if current_user.participating_users.find_by(event_id: @event.id) %>
          <button class="btn btn-primary" disabled>Signed Up!</button>
          <%= link_to "Cancel Registration",
          participating_user_path(current_user.participating_users.find_by(event_id: @event.id)),
           data: { turbo_method: :delete, confirm: "Are you sure you want to cancel your registration?" },
          class: "btn btn-danger" %>
        <% else %>
          <%= simple_form_for [@event, @participating_user] do |form| %>
            <%= form.submit 'Sign up' %>
          <% end %>
        <% end %>
      <% end %>

  </div>
 </div>

 <div class="row mt-5">
    <div class="card text-center" style="width: 20%; margin: auto;">
      <div class="container" style="padding: 20px">
        <h3 class="text-center text-primary"><b>Chat for <%= @event.title %></b></h3>
          <%= link_to 'Join the chat', chatroom_path(@chatroom), class: "btn btn-secondary btn-sm" %>
      </div>
    </div>
</div>
<div class="row mt-5">
    <div class="col-12 text-center">
      <%= link_to "Back to all events", events_path, class: "btn btn-primary", input_html: {role: "button"}%>
  </div>
</div>
